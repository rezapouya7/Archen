{# PATH: /Archen/reports/templates/reports/log_details_panel.html #}

<div class="space-y-4 w-full overflow-x-hidden">
  <style>
    .num-ltr { direction: ltr; unicode-bidi: isolate; display: inline-block; }
  </style>

  <!-- Title (export buttons moved out to the list header) -->
  <div class="flex items-center justify-between flex-wrap gap-2">
    <div class="min-w-0">
      <div class="text-base font-bold text-gray-800">
        {% if job and job.job_number %}
          ثبت کار: {{ job.job_number }}
        {% else %}
          ثبت کار
        {% endif %}
      </div>
      <div class="text-xs text-gray-500">
        {% if jdate and time_str %}
          <span class="num-ltr">{{ jdate }}</span> • <span class="num-ltr">{{ time_str }}</span>
        {% elif jdate %}
          <span class="num-ltr">{{ jdate }}</span>
        {% elif time_str %}
          <span class="num-ltr">{{ time_str }}</span>
        {% endif %}
      </div>
    </div>
    <!-- English: Export buttons removed here to avoid duplication; now shown above the logs list title. -->
  </div>

  <!-- Flags as chips (mirrors job panel style) -->
  {% if badges %}
  <div class="p-2 rounded-lg border border-gray-200/70">
    <div class="text-sm font-bold text-gray-700 mb-1">برچسب‌ها</div>
    <div class="flex items-center gap-2 overflow-x-auto w-full flex-nowrap md:flex-wrap">
      {% for b in badges %}
        <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-bold bg-gray-100 text-gray-700 shrink-0">{{ b }}</span>
      {% endfor %}
    </div>
  </div>
  {% endif %}

  <!-- Info grid -->
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 bg-gray-50/60 rounded-lg p-3 border border-gray-200/70">
    <div><div class="text-xs text-gray-500">شماره کار</div><div class="text-sm font-bold break-words">{{ job.job_number|default:'-' }}</div></div>
    <div><div class="text-xs text-gray-500">بخش</div><div class="text-sm font-bold break-words">{{ section_label }}</div></div>
    <div><div class="text-xs text-gray-500">کاربر</div><div class="text-sm font-bold break-words">{{ user.full_name|default:user.username }}</div></div>
    <div><div class="text-xs text-gray-500">تاریخ</div><div class="text-sm"><span class="num-ltr">{{ jdate }}</span></div></div>
    <div><div class="text-xs text-gray-500">ساعت</div><div class="text-sm"><span class="num-ltr">{{ time_str }}</span></div></div>
    
    {% if job and job.product %}
      <div><div class="text-xs text-gray-500">محصول</div><div class="text-sm font-bold break-words">{{ job.product.name|default:'-' }}</div></div>
      <div><div class="text-xs text-gray-500">مدل</div><div class="text-sm font-bold break-words">{{ job.product.product_model.name|default:'-' }}</div></div>
    {% endif %}
  </div>
</div>

<!-- Segmented blocks (aligned with job details panel) -->
{% if is_parts %}
<div class="mt-3 border border-gray-200/70 rounded-lg">
  <div class="px-3 py-2 bg-gray-50 text-sm font-bold text-gray-700">تعداد قطعه</div>
  <div class="p-3 grid grid-cols-1 sm:grid-cols-2 gap-3 text-center">
    <div class="bg-white rounded-md border border-gray-200/70 p-3">
      <div class="text-xs text-gray-500 mb-1">تعداد تولید قطعه</div>
      <div class="text-2xl font-extrabold text-gray-800">{{ produced_qty|default:0 }}</div>
    </div>
    <div class="bg-white rounded-md border border-gray-200/70 p-3">
      <div class="text-xs text-gray-500 mb-1">تعداد ضایعات قطعه</div>
      <div class="text-2xl font-extrabold text-gray-800">{{ scrap_qty|default:0 }}</div>
    </div>
  </div>
</div>
{% endif %}

<div class="mt-3 border border-gray-200/70 rounded-lg">
  <div class="px-3 py-2 bg-gray-50 text-sm font-bold text-gray-700">توضیحات گزارش</div>
  <div class="p-3 text-sm text-gray-800">{{ report_desc|default:'-' }}</div>
  </div>

<div class="mt-3 border border-gray-200/70 rounded-lg">
  <div class="px-3 py-2 bg-gray-50 text-sm font-bold text-gray-700">یادداشت</div>
  <div class="p-3 text-sm text-gray-800">{{ log.note|default:'-' }}</div>
</div>


